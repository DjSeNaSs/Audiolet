<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />

        <title>Audiolet API Documentation</title>

        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Inconsolata&amp;v1" />
        <link rel="stylesheet" href="css/museo-sans/stylesheet.css" />

        <link rel="stylesheet" href="css/html5reset-1.6.1.css" />
        <link rel="stylesheet" href="css/pygments/tango.css" />
        <link rel="stylesheet" href="css/oxo.css" />

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
        <script src="js/jquery.EqualHeights.js"></script>
        <script src="js/oxo.js"></script>
    </head>
    <body>
        <div id="container"> 
            <!-- Documentation title and description -->
            <div id="title">
                <div class="header block">
                    <div class="left">
                        <div>
                            <h1>
                                Audiolet API Documentation
                            </h1>
                            <p>JavaScript library for audio synthesis and composition.</p>

                        </div>
                    </div>
                    <div class="right">
                        <div>&nbsp;</div>
                    </div>
                    <div class="clear"></div>
                </div>
            </div>

            <!-- Single files -->
            

            <!-- Sections -->
            <div class="section">
                <div class="header block">
                    <div class="left">
                        <div>
                            <h2>Core</h2>
                        </div>
                    </div>
                    <div class="right">
                        <div><p>Core Audiolet classes</p>
</div>
                    </div>
                    <div class="clear"></div>
                </div>

                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>AudioletNode</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/AudioletNode.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>The basic building block of Audiolet applications.  Nodes are connected
together to create a processing graph which governs the flow of audio data.
AudioletNodes can contain any number of inputs and outputs which send and
receive one or more channels of audio data.  Audio data is created and
processed using the generate function, which is called whenever new data is
needed.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfInputs The number of inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfOutputs The number of outputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> [generate] A replacement for the generate function.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AudioletNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">numberOfInputs</span><span class="p">,</span> <span class="nx">numberOfOutputs</span><span class="p">,</span>
                            <span class="nx">generate</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span> <span class="o">=</span> <span class="nx">audiolet</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="nx">numberOfInputs</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="nx">numberOfOutputs</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfInputs</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">AudioletInput</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">i</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfOutputs</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">AudioletOutput</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">i</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">generate</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="nx">generate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Connect the node to another node or group.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletNode|AudioletGroup</em> node The node to connect to.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [output=0] The index of the output to connect from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [input=0] The index of the input to connect to.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">connect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">output</span><span class="p">,</span> <span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">node</span> <span class="k">instanceof</span> <span class="nx">AudioletGroup</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Connect to the pass-through node rather than the group</span>
        <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">input</span> <span class="o">||</span> <span class="mi">0</span><span class="p">];</span>
        <span class="nx">input</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">outputPin</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">output</span> <span class="o">||</span> <span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">inputPin</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">input</span> <span class="o">||</span> <span class="mi">0</span><span class="p">];</span>
    <span class="nx">outputPin</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">inputPin</span><span class="p">);</span>
    <span class="nx">inputPin</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">outputPin</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Disconnect the node from another node or group</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletNode|AudioletGroup</em> node The node to disconnect from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [output=0] The index of the output to disconnect.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [input=0] The index of the input to disconnect.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">disconnect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">output</span><span class="p">,</span> <span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">node</span> <span class="k">instanceof</span> <span class="nx">AudioletGroup</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">input</span> <span class="o">||</span> <span class="mi">0</span><span class="p">];</span>
        <span class="nx">input</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">outputPin</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">output</span> <span class="o">||</span> <span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">inputPin</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">input</span> <span class="o">||</span> <span class="mi">0</span><span class="p">];</span>
    <span class="nx">inputPin</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">outputPin</span><span class="p">);</span>
    <span class="nx">outputPin</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">inputPin</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Force an output to contain a fixed number of channels.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> output The index of the output.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfChannels The number of channels.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setNumberOfOutputChannels</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">output</span><span class="p">,</span>
                                                            <span class="nx">numberOfChannels</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">output</span><span class="p">].</span><span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">numberOfChannels</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Link an output to an input, forcing the output to always contain the
same number of channels as the input.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> output The index of the output.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> input The index of the input.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">output</span><span class="p">,</span> <span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">output</span><span class="p">].</span><span class="nx">linkNumberOfChannels</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">input</span><span class="p">]);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a buffer of samples, first pulling any necessary data from
higher up the processing graph.  This function should not be called
manually by users, who should instead rely on automatic ticking from
connections to the AudioletDevice.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples to process.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> timestamp A timestamp for the block of samples.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">tick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">,</span> <span class="nx">timestamp</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">timestamp</span> <span class="o">!=</span> <span class="k">this</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Need to set the timestamp before we tick the parents so we</span>
        <span class="c1">// can&#39;t get into infinite loops where there is feedback in the</span>
        <span class="c1">// graph</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="nx">timestamp</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">tickParents</span><span class="p">(</span><span class="nx">length</span><span class="p">,</span> <span class="nx">timestamp</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">inputBuffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createInputBuffers</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputBuffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createOutputBuffers</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">generate</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Call the tick function on nodes which are connected to the inputs.  This
function should not be called manually by users.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples to process.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> timestamp A timestamp for the block of samples.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">tickParents</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">,</span> <span class="nx">timestamp</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfInputs</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">numberOfStreams</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="c1">// Tick backwards, as the input may disconnect itself during the</span>
        <span class="c1">// loop</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfStreams</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">numberOfStreams</span> <span class="o">-</span> <span class="nx">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
            <span class="nx">input</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">[</span><span class="nx">index</span><span class="p">].</span><span class="nx">node</span><span class="p">.</span><span class="nx">tick</span><span class="p">(</span><span class="nx">length</span><span class="p">,</span> <span class="nx">timestamp</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples, reading from the input buffers and putting
new values into the output buffers.  Override me!</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Sane default - pass along any empty flags</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span> <span class="o">&amp;&amp;</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">outputBuffers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Create the input buffers by grabbing data from the outputs of connected
nodes and summing it.  If no nodes are connected to an input, then
give a one channel empty buffer.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples for the resulting buffers.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>AudioletBuffer[]</em> The input buffers.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">createInputBuffers</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfInputs</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

        <span class="c1">// Find the non-empty output with the most channels</span>
        <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">largestOutput</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">connectedFrom</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">numberOfConnections</span> <span class="o">=</span> <span class="nx">connectedFrom</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfConnections</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">connectedFrom</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span> <span class="o">&gt;</span> <span class="nx">numberOfChannels</span> <span class="o">&amp;&amp;</span>
                <span class="o">!</span><span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
                <span class="nx">largestOutput</span> <span class="o">=</span> <span class="nx">output</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">largestOutput</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// TODO: Optimizations</span>
            <span class="c1">// We have non-empty connections</span>

            <span class="c1">// Resize the input buffer accordingly</span>
            <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">buffer</span><span class="p">;</span>
            <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="nx">numberOfChannels</span><span class="p">,</span> <span class="nx">length</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
            <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

            <span class="c1">// Set the buffer using the largest output</span>
            <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">largestOutput</span><span class="p">.</span><span class="nx">getBuffer</span><span class="p">(</span><span class="nx">length</span><span class="p">));</span>

            <span class="c1">// Sum the rest of the outputs</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfConnections</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">connectedFrom</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">output</span> <span class="o">!=</span> <span class="nx">largestOutput</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">output</span><span class="p">.</span><span class="nx">getBuffer</span><span class="p">(</span><span class="nx">length</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="nx">inputBuffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inputBuffer</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// If we don&#39;t have any non-empty connections give a single</span>
            <span class="c1">// channel empty buffer of the correct length</span>
            <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">buffer</span><span class="p">;</span>
            <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">length</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
            <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">inputBuffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inputBuffer</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">inputBuffers</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Create output buffers of the correct length.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples for the resulting buffers.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>AudioletNode[]</em> The output buffers.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">createOutputBuffers</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Create the output buffers</span>
    <span class="kd">var</span> <span class="nx">outputBuffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfOutputs</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="nx">output</span><span class="p">.</span><span class="nx">getNumberOfChannels</span><span class="p">(),</span> <span class="nx">length</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="nx">outputBuffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">outputBuffers</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Remove the node completely from the processing graph, disconnecting all
of its inputs and outputs.</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Disconnect inputs</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">numberOfStreams</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfStreams</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">outputPin</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">outputPin</span><span class="p">.</span><span class="nx">node</span><span class="p">;</span>
            <span class="nx">output</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">outputPin</span><span class="p">.</span><span class="nx">index</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Disconnect outputs</span>
    <span class="kd">var</span> <span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">numberOfStreams</span> <span class="o">=</span> <span class="nx">output</span><span class="p">.</span><span class="nx">connectedTo</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfStreams</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputPin</span> <span class="o">=</span> <span class="nx">output</span><span class="p">.</span><span class="nx">connectedTo</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nx">inputPin</span><span class="p">.</span><span class="nx">node</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">inputPin</span><span class="p">.</span><span class="nx">index</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>AudioletGroup</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/AudioletGroup.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A container for collections of connected AudioletNodes.  Groups make it
possible to create multiple copies of predefined networks of nodes,
without having to manually create and connect up each individual node.</p>

<p>From the outside groups look and behave exactly the same as nodes.
Internally you can connect nodes directly to the group's inputs and
outputs, allowing connection to nodes outside of the group.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfInputs The number of inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfOutputs The number of outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AudioletGroup</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">numberOfInputs</span><span class="p">,</span> <span class="nx">numberOfOutputs</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span> <span class="o">=</span> <span class="nx">audiolet</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="nx">numberOfInputs</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="nx">numberOfOutputs</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">PassThroughNode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">PassThroughNode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Connect the group to another node or group</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletNode|AudioletGroup</em> node The node to connect to.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [output=0] The index of the output to connect from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [input=0] The index of the input to connect to.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletGroup</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">connect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">output</span><span class="p">,</span> <span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">output</span> <span class="o">||</span> <span class="mi">0</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">input</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Disconnect the group from another node or group</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletNode|AudioletGroup</em> node The node to disconnect from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [output=0] The index of the output to disconnect.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [input=0] The index of the input to disconnect.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletGroup</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">disconnect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">output</span><span class="p">,</span> <span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">output</span> <span class="o">||</span> <span class="mi">0</span><span class="p">].</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">input</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Remove the group completely from the processing graph, disconnecting all
of its inputs and outputs</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletGroup</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">remove</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">remove</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                
            </div>
            <div class="section">
                <div class="header block">
                    <div class="left">
                        <div>
                            <h2>DSP</h2>
                        </div>
                    </div>
                    <div class="right">
                        <div><p>Audio generation and processing classes</p>
</div>
                    </div>
                    <div class="clear"></div>
                </div>

                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>TableLookupOscillator</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/TableLookupOscillator.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Oscillator which reads waveform values from a look-up table</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Waveform</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The oscillator frequency.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [frequency=440] The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">TableLookupOscillator</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">table</span> <span class="o">=</span> <span class="nx">table</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">frequency</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">frequency</span> <span class="o">||</span> <span class="mi">440</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">phase</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">TableLookupOscillator</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">TableLookupOscillator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span>
                                                    <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Make processing variables local</span>
    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">table</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">table</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">tableSize</span> <span class="o">=</span> <span class="nx">table</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">phase</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">phase</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">frequencyParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">frequency</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">frequency</span><span class="p">,</span> <span class="nx">frequencyChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">frequency</span> <span class="o">=</span> <span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">frequencyChannel</span> <span class="o">=</span> <span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// Processing loop</span>
    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">frequencyChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">frequency</span> <span class="o">=</span> <span class="nx">frequencyChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">step</span> <span class="o">=</span> <span class="nx">frequency</span> <span class="o">*</span> <span class="nx">tableSize</span> <span class="o">/</span> <span class="nx">sampleRate</span><span class="p">;</span>
        <span class="nx">phase</span> <span class="o">+=</span> <span class="nx">step</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">phase</span> <span class="o">&gt;=</span> <span class="nx">tableSize</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">phase</span> <span class="o">%=</span> <span class="nx">tableSize</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">channel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">table</span><span class="p">[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">phase</span><span class="p">)];</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">phase</span> <span class="o">=</span> <span class="nx">phase</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">TableLookupOscillator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Table Lookup Oscillator&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Sine</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Sine.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Sine wave oscillator using a lookup table</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Sine wave</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The frequency of the oscillator.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> TableLookupOscillator
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [frequency=440] Initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Sine</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">TableLookupOscillator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">Sine</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Sine</span><span class="p">,</span> <span class="nx">TableLookupOscillator</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Sine</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Sine&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Sine table</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Sine</span><span class="p">.</span><span class="nx">TABLE</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">8192</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Sine</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">/</span> <span class="mi">8192</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Triangle</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Triangle.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Triangle wave oscillator using a lookup table</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Triangle wave</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The frequency of the oscillator.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> TableLookupOscillator
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [frequency=440] Initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Triangle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">TableLookupOscillator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">Triangle</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Triangle</span><span class="p">,</span> <span class="nx">TableLookupOscillator</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Triangle</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Triangle&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Triangle table</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Triangle</span><span class="p">.</span><span class="nx">TABLE</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">8192</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Smelly, but looks right...</span>
    <span class="nx">Triangle</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(((((</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">2048</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8192</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Saw</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Saw.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Saw wave oscillator using a lookup table</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Saw wave</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The frequency of the oscillator.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> TableLookupOscillator
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [frequency=440] Initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Saw</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">TableLookupOscillator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">Saw</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Saw</span><span class="p">,</span> <span class="nx">TableLookupOscillator</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Saw</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Saw&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Saw table</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Saw</span><span class="p">.</span><span class="nx">TABLE</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">8192</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Saw</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">.</span><span class="nx">push</span><span class="p">(((((</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">4096</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8192</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Square</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Square.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Square wave oscillator using a lookup table</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Square wave</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The frequency of the oscillator.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> TableLookupOscillator
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [frequency=440] Initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Square</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">TableLookupOscillator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">Square</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Square</span><span class="p">,</span> <span class="nx">TableLookupOscillator</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Square</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Square&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Square wave table</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Square</span><span class="p">.</span><span class="nx">TABLE</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">8192</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Square</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">.</span><span class="nx">push</span><span class="p">(((</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">4096</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8192</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>WhiteNoise</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/WhiteNoise.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A white noise source</p>

<p><strong>Outputs</strong></p>

<ul>
<li>White noise</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">WhiteNoise</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">WhiteNoise</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">WhiteNoise</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Processing loop</span>
    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">channel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">WhiteNoise</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;White Noise&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Envelope</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Envelope.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A generic envelope consisting of linear transitions of varying duration
between a series of values.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Gate</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Envelope</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>gate Gate controlling the envelope.  Values should be 0 (off) or 1 (on).
Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [gate=1] Initial gate value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number[]</em> levels An array (of length n) of values to move between.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number[]</em> times An array of n-1 durations - one for each transition.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [releaseStage] Sustain at this stage until the the gate is 0.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> [onComplete] Function called as the envelope finishes.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Envelope</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">gate</span><span class="p">,</span> <span class="nx">levels</span><span class="p">,</span> <span class="nx">times</span><span class="p">,</span> <span class="nx">releaseStage</span><span class="p">,</span>
                        <span class="nx">onComplete</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gate</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">gate</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">levels</span> <span class="o">=</span> <span class="nx">levels</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">times</span> <span class="o">=</span> <span class="nx">times</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">releaseStage</span> <span class="o">=</span> <span class="nx">releaseStage</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">onComplete</span> <span class="o">=</span> <span class="nx">onComplete</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">stage</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">changeTime</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">level</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delta</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gateOn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Envelope</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Envelope</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">gateParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">gate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">gate</span><span class="p">,</span> <span class="nx">gateChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">gateParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">gate</span> <span class="o">=</span> <span class="nx">gateParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">gateChannel</span> <span class="o">=</span> <span class="nx">gateParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">releaseStage</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">releaseStage</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">stage</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">stage</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">time</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">time</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">changeTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">changeTime</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">level</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">level</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">delta</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">delta</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">gateOn</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">gateOn</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">stageChanged</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">gateChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">gate</span> <span class="o">=</span> <span class="nx">gateChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">gate</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">gateOn</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Key pressed</span>
            <span class="nx">gateOn</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">stage</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nx">time</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nx">stageChanged</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">gateOn</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">gate</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Key released</span>
            <span class="nx">gateOn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">releaseStage</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Jump to the release stage</span>
                <span class="nx">stage</span> <span class="o">=</span> <span class="nx">releaseStage</span><span class="p">;</span>
                <span class="nx">stageChanged</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">changeTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// We are not sustaining, and we are playing, so increase the</span>
            <span class="c1">// time</span>
            <span class="nx">time</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">time</span> <span class="o">&gt;=</span> <span class="nx">changeTime</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Need to go to the next stage</span>
                <span class="nx">stage</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">stage</span> <span class="o">!=</span> <span class="nx">releaseStage</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">stageChanged</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="c1">// If we reach the release stage then sustain the value</span>
                    <span class="c1">// until the gate is released rather than moving on</span>
                    <span class="c1">// to the next level.</span>
                    <span class="nx">changeTime</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                    <span class="nx">delta</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">stageChanged</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">level</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">levels</span><span class="p">[</span><span class="nx">stage</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">stage</span> <span class="o">!=</span> <span class="k">this</span><span class="p">.</span><span class="nx">times</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Actually update the variables</span>
                <span class="nx">delta</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">calculateDelta</span><span class="p">(</span><span class="nx">stage</span><span class="p">,</span> <span class="nx">level</span><span class="p">);</span>
                <span class="nx">changeTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">calculateChangeTime</span><span class="p">(</span><span class="nx">stage</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// Made it to the end, so finish up</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="nx">stage</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                <span class="nx">time</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                <span class="nx">changeTime</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

                <span class="nx">delta</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">stageChanged</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">level</span> <span class="o">+=</span> <span class="nx">delta</span><span class="p">;</span>
        <span class="nx">channel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">level</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">stage</span> <span class="o">=</span> <span class="nx">stage</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="nx">time</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">changeTime</span> <span class="o">=</span> <span class="nx">changeTime</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">level</span> <span class="o">=</span> <span class="nx">level</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delta</span> <span class="o">=</span> <span class="nx">delta</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gateOn</span> <span class="o">=</span> <span class="nx">gateOn</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the change in level needed each sample for a section</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> stage The index of the current stage.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> level The current level.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The change in level.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Envelope</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateDelta</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">stage</span><span class="p">,</span> <span class="nx">level</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">delta</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">levels</span><span class="p">[</span><span class="nx">stage</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nx">level</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">stageTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">times</span><span class="p">[</span><span class="nx">stage</span><span class="p">]</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">delta</span> <span class="o">/</span> <span class="nx">stageTime</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the time in samples at which the next stage starts</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> stage The index of the current stage.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> time The current time.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The change time.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Envelope</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateChangeTime</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">stage</span><span class="p">,</span> <span class="nx">time</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">stageTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">times</span><span class="p">[</span><span class="nx">stage</span><span class="p">]</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">time</span> <span class="o">+</span> <span class="nx">stageTime</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Envelope</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Envelope&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>ADSREnvelope</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/ADSREnvelope.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Linear attack-decay-sustain-release envelope</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Gate</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Envelope</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>gate The gate turning the envelope on and off.  Value changes from 0 -> 1
trigger the envelope.  Value changes from 1 -> 0 make the envelope move to
its release stage.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Envelope
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> gate The initial gate value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> attack The attack time in seconds.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> decay The decay time in seconds.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> sustain The sustain level (between 0 and 1).
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> release The release time in seconds.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> onComplete A function called after the release stage.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">ADSREnvelope</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">gate</span><span class="p">,</span> <span class="nx">attack</span><span class="p">,</span> <span class="nx">decay</span><span class="p">,</span> <span class="nx">sustain</span><span class="p">,</span> <span class="nx">release</span><span class="p">,</span>
                            <span class="nx">onComplete</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">sustain</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">times</span> <span class="o">=</span> <span class="p">[</span><span class="nx">attack</span><span class="p">,</span> <span class="nx">decay</span><span class="p">,</span> <span class="nx">release</span><span class="p">];</span>
    <span class="nx">Envelope</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">gate</span><span class="p">,</span> <span class="nx">levels</span><span class="p">,</span> <span class="nx">times</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">onComplete</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">ADSREnvelope</span><span class="p">,</span> <span class="nx">Envelope</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">ADSREnvelope</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;ADSR Envelope&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>PercussiveEnvelope</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/PercussiveEnvelope.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Simple attack-release envelope</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Gate</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Envelope</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>gate The gate controlling the envelope.  Value changes from 0 -> 1
trigger the envelope.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Envelope
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> gate The initial gate value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> attack The attack time in seconds.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> release The release time in seconds.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> [onComplete] A function called after the release stage.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">PercussiveEnvelope</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">gate</span><span class="p">,</span> <span class="nx">attack</span><span class="p">,</span> <span class="nx">release</span><span class="p">,</span>
                                  <span class="nx">onComplete</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">times</span> <span class="o">=</span> <span class="p">[</span><span class="nx">attack</span><span class="p">,</span> <span class="nx">release</span><span class="p">];</span>
    <span class="nx">Envelope</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">gate</span><span class="p">,</span> <span class="nx">levels</span><span class="p">,</span> <span class="nx">times</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">onComplete</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">PercussiveEnvelope</span><span class="p">,</span> <span class="nx">Envelope</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PercussiveEnvelope</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Percussive Envelope&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>BufferPlayer</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/BufferPlayer.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Play the contents of an audio buffer</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Playback rate</li>
<li>Restart trigger</li>
<li>Start position</li>
<li>Loop on/off</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>playbackRate The rate that the buffer should play at.  Value of 1 plays at
the regular rate.  Values &gt; 1 are pitched up.  Values &lt; 1 are pitched down.
Linked to input 0.</li>
<li>restartTrigger Changes of value from 0 -> 1 restart the playback from the
start position.  Linked to input 1.</li>
<li>startPosition The position at which playback should begin.  Values between
0 (the beginning of the buffer) and 1 (the end of the buffer).  Linked to
input 2.</li>
<li>loop Whether the buffer should loop when it reaches the end.  Linked to
input 3</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer</em> buffer The buffer to play.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [playbackRate=1] The initial playback rate.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [startPosition=0] The initial start position.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [loop=0] Initial value for whether to loop.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">BufferPlayer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">,</span> <span class="nx">playbackRate</span><span class="p">,</span> <span class="nx">startPosition</span><span class="p">,</span>
                            <span class="nx">loop</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">startPosition</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">playbackRate</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">playbackRate</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">restartTrigger</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">startPosition</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">startPosition</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">loop</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">restartTriggerOn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">playing</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">BufferPlayer</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BufferPlayer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="c1">// Cache local variables</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">position</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">position</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">playing</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">playing</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">restartTriggerOn</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">restartTriggerOn</span><span class="p">;</span>

    <span class="c1">// Crap load of parameters</span>
    <span class="kd">var</span> <span class="nx">playbackRateParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">playbackRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">playbackRate</span><span class="p">,</span> <span class="nx">playbackRateChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">playbackRateParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">playbackRate</span> <span class="o">=</span> <span class="nx">playbackRateParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">playbackRateChannel</span> <span class="o">=</span> <span class="nx">playbackRateParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">restartTriggerParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">restartTrigger</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">restartTrigger</span><span class="p">,</span> <span class="nx">restartTriggerChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">restartTriggerParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">restartTrigger</span> <span class="o">=</span> <span class="nx">restartTriggerParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">restartTriggerChannel</span> <span class="o">=</span> <span class="nx">restartTriggerParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">startPositionParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">startPosition</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">startPosition</span><span class="p">,</span> <span class="nx">startPositionChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">startPositionParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">startPosition</span> <span class="o">=</span> <span class="nx">startPositionParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">startPositionChannel</span> <span class="o">=</span> <span class="nx">startPositionParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">loopParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">loop</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">loop</span><span class="p">,</span> <span class="nx">loopChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">loopParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">loop</span> <span class="o">=</span> <span class="nx">loopParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">loopChannel</span> <span class="o">=</span> <span class="nx">loopParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="k">if</span> <span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="nx">restartTriggerChannel</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">playing</span><span class="p">))</span> <span class="p">{</span>
        <span class="c1">// No buffer data, or chance of starting playing in this block, so</span>
        <span class="c1">// we can just send an empty buffer and return</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">playbackRateChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">playbackRate</span> <span class="o">=</span> <span class="nx">playbackRateChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">restartTriggerChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">restartTrigger</span> <span class="o">=</span> <span class="nx">restartTriggerChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">loopChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">loop</span> <span class="o">=</span> <span class="nx">loopChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">restartTrigger</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">restartTriggerOn</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Trigger moved from &lt;=0 to &gt;0, so we restart playback from</span>
            <span class="c1">// startPosition</span>
            <span class="nx">position</span> <span class="o">=</span> <span class="nx">startPosition</span><span class="p">;</span>
            <span class="nx">restartTriggerOn</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">playing</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">restartTrigger</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">restartTriggerOn</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Trigger moved back to &lt;= 0</span>
            <span class="nx">restartTriggerOn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">playing</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">position</span><span class="p">)];</span>
            <span class="p">}</span>
            <span class="nx">position</span> <span class="o">+=</span> <span class="nx">playbackRate</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">position</span> <span class="o">&gt;=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">loop</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">// Back to the start</span>
                    <span class="nx">position</span> <span class="o">%=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="c1">// Finish playing until a new restart trigger</span>
                    <span class="nx">playing</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// Give zeros until we restart</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">playing</span> <span class="o">=</span> <span class="nx">playing</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">position</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">restartTriggerOn</span> <span class="o">=</span> <span class="nx">restartTriggerOn</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BufferPlayer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Buffer player&#39;</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Gain</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Gain.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Simple gain control</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Gain</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>gain The amount of gain.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [gain=1] Initial gain.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Gain</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">gain</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gain</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">gain</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Gain</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Gain</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">gainParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">gain</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">gain</span><span class="p">,</span> <span class="nx">gainChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">gainParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">gain</span> <span class="o">=</span> <span class="nx">gainParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">gainChannel</span> <span class="o">=</span> <span class="nx">gainParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">gainChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">gain</span> <span class="o">=</span> <span class="nx">gainChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">*</span> <span class="nx">gain</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Gain</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Gain&#39;</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Pan</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Pan.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Position a single-channel input in stereo space</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Pan Position</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Panned audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>pan The pan position.  Values between 0 (hard-left) and 1 (hard-right).
Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [pan=0.5] The initial pan position.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Pan</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">pan</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="c1">// Hardcode two output channels</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pan</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">pan</span> <span class="o">||</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Pan</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Pan</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">leftOutputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">rightOutputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">panParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">pan</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">pan</span><span class="p">,</span> <span class="nx">panChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">panParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">pan</span> <span class="o">=</span> <span class="nx">panParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">panChannel</span> <span class="o">=</span> <span class="nx">panParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">panChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">pan</span> <span class="o">=</span> <span class="nx">panChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">scaledPan</span> <span class="o">=</span> <span class="nx">pan</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="c1">// TODO: Use sine/cos tables?</span>
        <span class="nx">leftOutputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">scaledPan</span><span class="p">);</span>
        <span class="nx">rightOutputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">scaledPan</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Pan</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Stereo Panner&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>UpMixer</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/UpMixer.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Upmix an input to a constant number of output channels</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Upmixed audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> outputChannels The number of output channels.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">UpMixer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">outputChannels</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputChannels</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">UpMixer</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">UpMixer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputChannels</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">outputChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span> <span class="o">%</span> <span class="nx">numberOfChannels</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="nx">outputChannel</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">inputChannel</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">UpMixer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;UpMixer&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>LinearCrossFade</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/LinearCrossFade.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Linear cross-fade between two signals</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio 1</li>
<li>Audio 2</li>
<li>Fade Position</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Mixed audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>position The fade position.  Values between 0 (Audio 1 only) and 1 (Audio
2 only).  Linked to input 2.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [position=0.5] The initial fade position.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">LinearCrossFade</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">position</span> <span class="o">||</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">LinearCrossFade</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">LinearCrossFade</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBufferA</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">inputBufferB</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="kd">var</span> <span class="nx">inputChannelsA</span> <span class="o">=</span> <span class="nx">inputBufferA</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">inputChannelsB</span> <span class="o">=</span> <span class="nx">inputBufferB</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBufferA</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">||</span> <span class="nx">inputBufferB</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">positionParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">position</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">position</span><span class="p">,</span> <span class="nx">positionChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">positionParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">position</span> <span class="o">=</span> <span class="nx">positionParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">positionChannel</span> <span class="o">=</span> <span class="nx">positionParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">positionChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">position</span> <span class="o">=</span> <span class="nx">positionChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">gainA</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">position</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">gainB</span> <span class="o">=</span> <span class="nx">position</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBufferA</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputChannelA</span> <span class="o">=</span> <span class="nx">inputChannelsA</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">inputChannelB</span> <span class="o">=</span> <span class="nx">inputChannelsB</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>

            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannelA</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">gainA</span> <span class="o">+</span>
                               <span class="nx">inputChannelB</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">gainB</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">LinearCrossFade</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Linear Cross Fader&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Limiter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Limiter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A simple (and frankly shoddy) zero-lookahead limiter.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Threshold</li>
<li>Attack</li>
<li>Release</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Limited audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>threshold The limiter threshold.  Linked to input 1.</li>
<li>attack The attack time in seconds. Linked to input 2.</li>
<li>release The release time in seconds.  Linked to input 3.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletGroup
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [threshold=0.95] The initial threshold.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [attack=0.01] The initial attack time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [release=0.4] The initial release time.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Limiter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">threshold</span><span class="p">,</span> <span class="nx">attack</span><span class="p">,</span> <span class="nx">release</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletGroup</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Parameters</span>
    <span class="kd">var</span> <span class="nx">attack</span> <span class="o">=</span> <span class="nx">attack</span> <span class="o">||</span> <span class="mf">0.01</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">attackNode</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ParameterNode</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">attack</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">attack</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">attackNode</span><span class="p">.</span><span class="nx">parameter</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">release</span> <span class="o">=</span> <span class="nx">release</span> <span class="o">||</span> <span class="mf">0.4</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">releaseNode</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ParameterNode</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">release</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">release</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">releaseNode</span><span class="p">.</span><span class="nx">parameter</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">amplitude</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Amplitude</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">limitFromAmplitude</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LimitFromAmplitude</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">threshold</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">threshold</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">limitFromAmplitude</span><span class="p">.</span><span class="nx">threshold</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">amplitude</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">limitFromAmplitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">limitFromAmplitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">attackNode</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">releaseNode</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">attackNode</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">amplitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">releaseNode</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">amplitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">amplitude</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">limitFromAmplitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">limitFromAmplitude</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Limiter</span><span class="p">,</span> <span class="nx">AudioletGroup</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Limiter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Limiter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Helper node which limits a signal based on an amplitude input.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Amplitude</li>
<li>Threshold</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Limited audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>threshold The limiter threshold.  Linked to input 2.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [threshold=0.95] The initial threshold.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">LimitFromAmplitude</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">threshold</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">threshold</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">threshold</span> <span class="o">||</span> <span class="mf">0.95</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">LimitFromAmplitude</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">LimitFromAmplitude</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">amplitudeBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">amplitudeChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">||</span> <span class="nx">amplitudeBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">thresholdParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">threshold</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">threshold</span><span class="p">,</span> <span class="nx">thresholdChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">thresholdParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">threshold</span> <span class="o">=</span> <span class="nx">thresholdParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">thresholdChannel</span> <span class="o">=</span> <span class="nx">thresholdParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">amplitude</span> <span class="o">=</span> <span class="nx">amplitudeChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">thresholdChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">threshold</span> <span class="o">=</span> <span class="nx">thresholdChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>

            <span class="kd">var</span> <span class="nx">diff</span> <span class="o">=</span> <span class="nx">amplitude</span> <span class="o">-</span> <span class="nx">threshold</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nx">diff</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">LimitFromAmplitude</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Limit From Amplitude&#39;</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>BiquadFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/BiquadFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Generic biquad filter.  The coefficients (a0, a1, a2, b0, b1 and b2) are set
using the calculateCoefficients function, which should be overridden and
will be called automatically when new values are needed.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Filter frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The filter frequency.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">BiquadFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Same number of output channels as input channels</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">frequency</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">frequency</span> <span class="o">||</span> <span class="mi">22100</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastFrequency</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// See if we need to recalculate coefficients</span>

    <span class="c1">// Delayed values</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">xValues</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">yValues</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="c1">// Coefficients</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">BiquadFilter</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the biquad filter coefficients.  This should be overridden.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The filter frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateCoefficients</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">xValueArray</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">xValues</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">yValueArray</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yValues</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">inputChannels</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">inputChannels</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
        <span class="nx">outputChannels</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">xValueArray</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">xValueArray</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span>
            <span class="nx">yValueArray</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">frequencyParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">frequency</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">frequency</span><span class="p">,</span> <span class="nx">frequencyChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">frequency</span> <span class="o">=</span> <span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">frequencyChannel</span> <span class="o">=</span> <span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">lastFrequency</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastFrequency</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">a0</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">a1</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a1</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">a2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a2</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">b0</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">b1</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b1</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">b2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b2</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">frequencyChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">frequency</span> <span class="o">=</span> <span class="nx">frequencyChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">frequency</span> <span class="o">!=</span> <span class="nx">lastFrequency</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Recalculate and make the coefficients local</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">calculateCoefficients</span><span class="p">(</span><span class="nx">frequency</span><span class="p">);</span>
            <span class="nx">lastFrequency</span> <span class="o">=</span> <span class="nx">frequency</span><span class="p">;</span>
            <span class="nx">a0</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a0</span><span class="p">;</span>
            <span class="nx">a1</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a1</span><span class="p">;</span>
            <span class="nx">a2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a2</span><span class="p">;</span>
            <span class="nx">b0</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b0</span><span class="p">;</span>
            <span class="nx">b1</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b1</span><span class="p">;</span>
            <span class="nx">b2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b2</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>

            <span class="kd">var</span> <span class="nx">xValues</span> <span class="o">=</span> <span class="nx">xValueArray</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">x1</span> <span class="o">=</span> <span class="nx">xValues</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">x2</span> <span class="o">=</span> <span class="nx">xValues</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">yValues</span> <span class="o">=</span> <span class="nx">yValueArray</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">y1</span> <span class="o">=</span> <span class="nx">yValues</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">y2</span> <span class="o">=</span> <span class="nx">yValues</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

            <span class="kd">var</span> <span class="nx">x0</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">y0</span> <span class="o">=</span> <span class="p">(</span><span class="nx">b0</span> <span class="o">/</span> <span class="nx">a0</span><span class="p">)</span> <span class="o">*</span> <span class="nx">x0</span> <span class="o">+</span>
                     <span class="p">(</span><span class="nx">b1</span> <span class="o">/</span> <span class="nx">a0</span><span class="p">)</span> <span class="o">*</span> <span class="nx">x1</span> <span class="o">+</span>
                     <span class="p">(</span><span class="nx">b2</span> <span class="o">/</span> <span class="nx">a0</span><span class="p">)</span> <span class="o">*</span> <span class="nx">x2</span> <span class="o">-</span>
                     <span class="p">(</span><span class="nx">a1</span> <span class="o">/</span> <span class="nx">a0</span><span class="p">)</span> <span class="o">*</span> <span class="nx">y1</span> <span class="o">-</span>
                     <span class="p">(</span><span class="nx">a2</span> <span class="o">/</span> <span class="nx">a0</span><span class="p">)</span> <span class="o">*</span> <span class="nx">y2</span><span class="p">;</span>

            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">y0</span><span class="p">;</span>


            <span class="nx">xValues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">x0</span><span class="p">;</span>
            <span class="nx">xValues</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">x1</span><span class="p">;</span>
            <span class="nx">yValues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">y0</span><span class="p">;</span>
            <span class="nx">yValues</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">y1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastFrequency</span> <span class="o">=</span> <span class="nx">lastFrequency</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Biquad Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>LowPassFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/LowPassFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Low-pass filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Filter frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The filter frequency.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> BiquadFilter
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">LowPassFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">LowPassFilter</span><span class="p">,</span> <span class="nx">BiquadFilter</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the biquad filter coefficients using maths from
http://www.musicdsp.org/files/Audio-EQ-Cookbook.txt</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The filter frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">LowPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateCoefficients</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">w0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">frequency</span> <span class="o">/</span>
             <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cosw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">sinw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">alpha</span> <span class="o">=</span> <span class="nx">sinw0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">b0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">cosw0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">alpha</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">LowPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Low Pass Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>HighPassFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/HighPassFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>High-pass filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Filter frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The filter frequency.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> BiquadFilter
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">HighPassFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">HighPassFilter</span><span class="p">,</span> <span class="nx">BiquadFilter</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the biquad filter coefficients using maths from
http://www.musicdsp.org/files/Audio-EQ-Cookbook.txt</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The filter frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">HighPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateCoefficients</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">w0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">frequency</span> <span class="o">/</span>
             <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cosw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">sinw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">alpha</span> <span class="o">=</span> <span class="nx">sinw0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">b0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nx">cosw0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b1</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nx">cosw0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">alpha</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">HighPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;High Pass Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>BandPassFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/BandPassFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Band-pass filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Filter frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The filter frequency.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> BiquadFilter
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">BandPassFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">BandPassFilter</span><span class="p">,</span> <span class="nx">BiquadFilter</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the biquad filter coefficients using maths from
http://www.musicdsp.org/files/Audio-EQ-Cookbook.txt</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The filter frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BandPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateCoefficients</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">w0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">frequency</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cosw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">sinw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">alpha</span> <span class="o">=</span> <span class="nx">sinw0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">b0</span> <span class="o">=</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b2</span> <span class="o">=</span> <span class="o">-</span><span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">alpha</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BandPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Band Pass Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>BandRejectFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/BandRejectFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Band-reject filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Filter frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The filter frequency.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> BiquadFilter
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">BandRejectFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">BandRejectFilter</span><span class="p">,</span> <span class="nx">BiquadFilter</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the biquad filter coefficients using maths from
http://www.musicdsp.org/files/Audio-EQ-Cookbook.txt</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The filter frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BandRejectFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateCoefficients</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">w0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">frequency</span> <span class="o">/</span>
             <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cosw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">sinw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">alpha</span> <span class="o">=</span> <span class="nx">sinw0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">b0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">alpha</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BandRejectFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Band Reject Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Lag</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Lag.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Exponential lag for smoothing signals.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Value</li>
<li>Lag time</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Lagged value</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>value The value to lag.  Linked to input 0.</li>
<li>lag The 60dB lag time. Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [value=0] The initial value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [lagTime=1] The initial lag time.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Lag</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">lagTime</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">value</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lag</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">lagTime</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span> <span class="o">=</span> <span class="nx">value</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">log001</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Lag</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Lag</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">log001</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">log001</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">valueParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">valueChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">valueParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">valueChannel</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">lagParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lag</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">lag</span><span class="p">,</span> <span class="nx">lagChannel</span><span class="p">,</span> <span class="nx">coefficient</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">lagParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">lag</span> <span class="o">=</span> <span class="nx">lagParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
        <span class="nx">coefficient</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">log001</span> <span class="o">/</span> <span class="p">(</span><span class="nx">lag</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">lagChannel</span> <span class="o">=</span> <span class="nx">lagParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">lastValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">valueChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="nx">coefficient</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">log001</span> <span class="o">/</span> <span class="p">(</span><span class="nx">lag</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">lagChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">lag</span> <span class="o">=</span> <span class="nx">lagChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">coefficient</span><span class="p">)</span> <span class="o">*</span> <span class="nx">value</span><span class="p">)</span> <span class="o">+</span>
                     <span class="p">(</span><span class="nx">coefficient</span> <span class="o">*</span> <span class="nx">lastValue</span><span class="p">);</span>
        <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">output</span><span class="p">;</span>
        <span class="nx">lastValue</span> <span class="o">=</span> <span class="nx">output</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span> <span class="o">=</span> <span class="nx">lastValue</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Lag</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Lag&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Delay</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Delay.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A simple delay line.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Delay Time</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Delayed audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>delayTime The delay time in seconds.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> maximumDelayTime The largest allowable delay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> delayTime The initial delay time.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Delay</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">maximumDelayTime</span><span class="p">,</span> <span class="nx">delayTime</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">delayTime</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Delay</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Delay</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">delayTimeParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">delayTime</span><span class="p">,</span> <span class="nx">delayTimeChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">delayTimeChannel</span> <span class="o">=</span> <span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">buffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">inputChannels</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">inputChannels</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
        <span class="nx">outputChannels</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
        <span class="c1">// Create buffer for channel if it doesn&#39;t already exist</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">buffers</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">;</span>
            <span class="nx">buffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="nx">bufferSize</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffers</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">readWriteIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">readWriteIndex</span> <span class="o">&gt;=</span> <span class="nx">delayTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="nx">readWriteIndex</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Delay</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Delay&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>CombFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/CombFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Undamped comb filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Delay Time</li>
<li>Decay Time</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>delayTime The delay time in seconds.  Linked to input 1.</li>
<li>decayTime Time for the echoes to decay by 60dB.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> maximumDelayTime The largest allowable delay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> delayTime The initial delay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> decayTime The initial decay time.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">CombFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">maximumDelayTime</span><span class="p">,</span> <span class="nx">delayTime</span><span class="p">,</span> <span class="nx">decayTime</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">delayTime</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">decayTime</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">CombFilter</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">CombFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">delayTimeParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">delayTime</span><span class="p">,</span> <span class="nx">delayTimeChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">delayTimeChannel</span> <span class="o">=</span> <span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">decayTimeParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">decayTime</span><span class="p">,</span> <span class="nx">decayTimeChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">decayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">decayTimeChannel</span> <span class="o">=</span> <span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">feedback</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">feedback</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="nx">delayTime</span> <span class="o">/</span> <span class="nx">decayTime</span><span class="p">);</span>
    <span class="p">}</span>



    <span class="kd">var</span> <span class="nx">buffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">inputChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfBuffers</span> <span class="o">=</span> <span class="nx">buffers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">numberOfBuffers</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Create buffer for channel if it doesn&#39;t already exist</span>
        <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">;</span>
        <span class="nx">buffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="nx">bufferSize</span><span class="p">));</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">decayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">decayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">decayTimeChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeChannel</span> <span class="o">||</span> <span class="nx">decayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">feedback</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="nx">delayTime</span> <span class="o">/</span> <span class="nx">decayTime</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffers</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">];</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">output</span><span class="p">;</span>
            <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span>
                                     <span class="nx">feedback</span> <span class="o">*</span> <span class="nx">output</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">readWriteIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">readWriteIndex</span> <span class="o">&gt;=</span> <span class="nx">delayTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="nx">readWriteIndex</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">CombFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Comb Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>DampedCombFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/DampedCombFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Damped comb filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Delay Time</li>
<li>Decay Time</li>
<li>Damping</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>delayTime The delay time in seconds.  Linked to input 1.</li>
<li>decayTime Time for the echoes to decay by 60dB.  Linked to input 2.</li>
<li>damping The amount of high-frequency damping of echoes.  Linked to input 3.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> maximumDelayTime The largest allowable delay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> delayTime The initial delay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> decayTime The initial decay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> damping The initial amount of damping.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">DampedCombFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">maximumDelayTime</span><span class="p">,</span> <span class="nx">delayTime</span><span class="p">,</span>
                                <span class="nx">decayTime</span><span class="p">,</span> <span class="nx">damping</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">delayTime</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">decayTime</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">damping</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">damping</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">filterStore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">DampedCombFilter</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">DampedCombFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">delayTimeParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">delayTime</span><span class="p">,</span> <span class="nx">delayTimeChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">delayTimeChannel</span> <span class="o">=</span> <span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">decayTimeParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">decayTime</span><span class="p">,</span> <span class="nx">decayTimeChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">decayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">decayTimeChannel</span> <span class="o">=</span> <span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">dampingParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">damping</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">damping</span><span class="p">,</span> <span class="nx">dampingChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">dampingParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">damping</span> <span class="o">=</span> <span class="nx">dampingParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">dampingChannel</span> <span class="o">=</span> <span class="nx">dampingParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">feedback</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">feedback</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="nx">delayTime</span> <span class="o">/</span> <span class="nx">decayTime</span><span class="p">);</span>
    <span class="p">}</span>



    <span class="kd">var</span> <span class="nx">buffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">filterStore</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">filterStore</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">inputChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfBuffers</span> <span class="o">=</span> <span class="nx">buffers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">numberOfBuffers</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Create buffer for channel if it doesn&#39;t already exist</span>
        <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">;</span>
        <span class="nx">buffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="nx">bufferSize</span><span class="p">));</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">decayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">decayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">decayTimeChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">dampingChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">damping</span> <span class="o">=</span> <span class="nx">dampingChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeChannel</span> <span class="o">||</span> <span class="nx">decayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">feedback</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="nx">delayTime</span> <span class="o">/</span> <span class="nx">decayTime</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffers</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">];</span>
            <span class="nx">filterStore</span> <span class="o">=</span> <span class="p">(</span><span class="nx">output</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">damping</span><span class="p">))</span> <span class="o">+</span>
                          <span class="p">(</span><span class="nx">filterStore</span> <span class="o">*</span> <span class="nx">damping</span><span class="p">);</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">output</span><span class="p">;</span>
            <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span>
                                     <span class="nx">feedback</span> <span class="o">*</span> <span class="nx">filterStore</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">readWriteIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">readWriteIndex</span> <span class="o">&gt;=</span> <span class="nx">delayTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="nx">readWriteIndex</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">filterStore</span> <span class="o">=</span> <span class="nx">filterStore</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">DampedCombFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Damped Comb Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Reverb</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Reverb.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Port of the Freeverb Schrodoer/Moorer reverb model.  See
https://ccrma.stanford.edu/~jos/pasp/Freeverb.html for a description of how
each part works.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Mix</li>
<li>Room Size</li>
<li>Damping</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Reverberated Audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>mix The wet/dry mix.  Values between 0 and 1.  Linked to input 1.</li>
<li>roomSize The reverb's room size.  Values between 0 and 1.  Linked to input
2.</li>
<li>damping The amount of high-frequency damping.  Values between 0 and 1.
Linked to input 3.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletGroup
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [mix=0.33] The initial wet/dry mix.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [roomSize=0.5] The initial room size.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [damping=0.5] The initial damping amount.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Reverb</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">mix</span><span class="p">,</span> <span class="nx">roomSize</span><span class="p">,</span> <span class="nx">damping</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletGroup</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Constants</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initialMix</span> <span class="o">=</span> <span class="mf">0.33</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">fixedGain</span> <span class="o">=</span> <span class="mf">0.015</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initialDamping</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scaleDamping</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initialRoomSize</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scaleRoom</span> <span class="o">=</span> <span class="mf">0.28</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">offsetRoom</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">;</span>

    <span class="c1">// Parameters: for 44.1k or 48k</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">combTuning</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1116</span><span class="p">,</span> <span class="mi">1188</span><span class="p">,</span> <span class="mi">1277</span><span class="p">,</span> <span class="mi">1356</span><span class="p">,</span> <span class="mi">1422</span><span class="p">,</span> <span class="mi">1491</span><span class="p">,</span> <span class="mi">1557</span><span class="p">,</span> <span class="mi">1617</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">allPassTuning</span> <span class="o">=</span> <span class="p">[</span><span class="mi">556</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">341</span><span class="p">,</span> <span class="mi">225</span><span class="p">];</span>

    <span class="c1">// Controls</span>
    <span class="c1">// Room size control</span>
    <span class="kd">var</span> <span class="nx">roomSize</span> <span class="o">=</span> <span class="nx">roomSize</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">initialRoomSize</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">roomSizeNode</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ParameterNode</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">roomSize</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">roomSizeMulAdd</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MulAdd</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">scaleRoom</span><span class="p">,</span>
                                     <span class="k">this</span><span class="p">.</span><span class="nx">offsetRoom</span><span class="p">);</span>

    <span class="c1">// Damping control</span>
    <span class="kd">var</span> <span class="nx">damping</span> <span class="o">=</span> <span class="nx">damping</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">initialDamping</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dampingNode</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ParameterNode</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">damping</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dampingMulAdd</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MulAdd</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">scaleDamping</span><span class="p">);</span>

    <span class="c1">// Access the controls as if this is an AudioletNode, and they are it&#39;s</span>
    <span class="c1">// parameters.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">roomSize</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">roomSizeNode</span><span class="p">.</span><span class="nx">parameter</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">damping</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dampingNode</span><span class="p">.</span><span class="nx">parameter</span><span class="p">;</span>

    <span class="c1">// Initial gain control</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gain</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Gain</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">fixedGain</span><span class="p">);</span>

    <span class="c1">// Eight comb filters and feedback gain converters</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">fgConverters</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">combTuning</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">delayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">combTuning</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">/</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DampedCombFilter</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">delayTime</span><span class="p">,</span>
                                                   <span class="nx">delayTime</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">fgConverters</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FeedbackGainToDecayTime</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span>
                                                           <span class="nx">delayTime</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Four allpass filters</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">allPassTuning</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AllPassFilter</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span>
                                                   <span class="k">this</span><span class="p">.</span><span class="nx">allPassTuning</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="c1">// Mixer</span>
    <span class="kd">var</span> <span class="nx">mix</span> <span class="o">=</span> <span class="nx">mix</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">initialMix</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">mixer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LinearCrossFade</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">mix</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">mix</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">mixer</span><span class="p">.</span><span class="nx">position</span><span class="p">;</span>

    <span class="c1">// Connect up the controls</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mixer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">roomSizeNode</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">roomSizeNode</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">roomSizeMulAdd</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dampingNode</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dampingNode</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dampingMulAdd</span><span class="p">);</span>

    <span class="c1">// Connect up the gain</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gain</span><span class="p">);</span>

    <span class="c1">// Connect up the comb filters</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">gain</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>

        <span class="c1">// Controls</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">roomSizeMulAdd</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">fgConverters</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fgConverters</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">dampingMulAdd</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Connect up the all pass filters</span>
    <span class="kd">var</span> <span class="nx">numberOfAllPassFilters</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfAllPassFilters</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mixer</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">lastAllPassIndex</span> <span class="o">=</span> <span class="nx">numberOfAllPassFilters</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span><span class="p">[</span><span class="nx">lastAllPassIndex</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mixer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">mixer</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Reverb</span><span class="p">,</span> <span class="nx">AudioletGroup</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Reverb</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Reverb&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Helper node to convert a feedback gain multiplier to a 60db decay time.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Feedback gain</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Decay time</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> delayTime The delay time in seconds
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">FeedbackGainToDecayTime</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">delayTime</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span> <span class="o">=</span> <span class="nx">delayTime</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastFeedbackGain</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">FeedbackGainToDecayTime</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">FeedbackGainToDecayTime</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span>
                                                      <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="kd">var</span> <span class="nx">delayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastDelayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">decayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">lastFeedbackGain</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastFeedbackGain</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">feedbackGain</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">feedbackGain</span> <span class="o">!=</span> <span class="nx">lastFeedbackGain</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">decayTime</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="nx">delayTime</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">feedbackGain</span><span class="p">);</span>
            <span class="nx">lastFeedbackGain</span> <span class="o">=</span> <span class="nx">feedbackGain</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">feedbackGain</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span> <span class="o">=</span> <span class="nx">decayTime</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastFeedbackGain</span> <span class="o">=</span> <span class="nx">lastFeedbackGain</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>SoftClip</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/SoftClip.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A soft-clipper, which distorts at values over +-0.5.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Clipped audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">SoftClip</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">SoftClip</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">SoftClip</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">value</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">/</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="nx">value</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">/</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">SoftClip</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;SoftClip&#39;</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Amplitude</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Amplitude.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Amplitude envelope follower</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Attack time</li>
<li>Release time</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Amplitude envelope</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>attack The attack time of the envelope follower.  Linked to input 1.</li>
<li>release The release time of the envelope follower.  Linked to input 2.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [attack=0.01] The initial attack time in seconds.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [release=0.01] The initial release time in seconds.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Amplitude</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">attack</span><span class="p">,</span> <span class="nx">release</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">followers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>

    <span class="c1">//        attack = Math.pow(0.01, 1 / (attack * sampleRate));</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">attack</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">attack</span> <span class="o">||</span> <span class="mf">0.01</span><span class="p">);</span>

    <span class="c1">//        release = Math.pow(0.01, 1 / (release * sampleRate));</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">release</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">release</span> <span class="o">||</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Amplitude</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Amplitude</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">followers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">followers</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfFollowers</span> <span class="o">=</span> <span class="nx">followers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">attackParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">attack</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">attack</span><span class="p">,</span> <span class="nx">attackChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">attackParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">attack</span> <span class="o">=</span> <span class="nx">attackParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">attackChannel</span> <span class="o">=</span> <span class="nx">attackParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">releaseParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">release</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">release</span><span class="p">,</span> <span class="nx">releaseChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">releaseParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">release</span> <span class="o">=</span> <span class="nx">releaseParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">releaseChannel</span> <span class="o">=</span> <span class="nx">releaseParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="nx">numberOfFollowers</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">followers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">follower</span> <span class="o">=</span> <span class="nx">followers</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">attackChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">attack</span> <span class="o">=</span> <span class="nx">attackChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">releaseChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">release</span> <span class="o">=</span> <span class="nx">releaseChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="nx">follower</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">follower</span> <span class="o">=</span> <span class="nx">attack</span> <span class="o">*</span> <span class="p">(</span><span class="nx">follower</span> <span class="o">-</span> <span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">follower</span> <span class="o">=</span> <span class="nx">release</span> <span class="o">*</span> <span class="p">(</span><span class="nx">follower</span> <span class="o">-</span> <span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">follower</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">followers</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">follower</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Amplitude</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>DiscontinuityDetector</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/DiscontinuityDetector.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Detect discontinuities in the input stream.  Looks for consecutive samples
with a difference larger than a threshold value.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> PassThroughNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [threshold=0.2] The threshold value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> [callback] Function called if a discontinuity is detected.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">DiscontinuityDetector</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">threshold</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">threshold</span> <span class="o">=</span> <span class="nx">threshold</span> <span class="o">||</span> <span class="mf">0.2</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastValues</span> <span class="o">=</span> <span class="p">[];</span>

<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">DiscontinuityDetector</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Default callback.  Logs the size and position of the discontinuity.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> size The size of the discontinuity.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> channel The index of the channel the samples were found in.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> index The sample index the discontinuity was found at.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">DiscontinuityDetector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">size</span><span class="p">,</span> <span class="nx">channel</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Discontinuity of &#39;</span> <span class="o">+</span> <span class="nx">size</span> <span class="o">+</span> <span class="s1">&#39; detected on channel &#39;</span> <span class="o">+</span>
                  <span class="nx">channel</span> <span class="o">+</span> <span class="s1">&#39; index &#39;</span> <span class="o">+</span> <span class="nx">index</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">DiscontinuityDetector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span>
                                                    <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">lastValues</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">lastValues</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastValues</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">threshold</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">threshold</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">lastValues</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">lastValues</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">lastValue</span> <span class="o">=</span> <span class="nx">lastValues</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">channel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">lastValue</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">lastValue</span> <span class="o">-</span> <span class="nx">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nx">threshold</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">lastValue</span> <span class="o">-</span> <span class="nx">value</span><span class="p">),</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nx">lastValue</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">lastValues</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">lastValue</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">DiscontinuityDetector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Discontinuity Detector&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>BadValueDetector</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/BadValueDetector.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Detect potentially hazardous values in the audio stream.  Looks for
undefineds, nulls, NaNs and Infinities.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> PassThroughNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> [callback] Function called if a bad value is detected.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">BadValueDetector</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">PassThroughNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">BadValueDetector</span><span class="p">,</span> <span class="nx">PassThroughNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Default callback.  Logs the value and position of the bad value.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number|Object|'undefined'</em> value The value detected.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> channel The index of the channel the value was found in.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> index The sample index the value was found at.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BadValueDetector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">channel</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">value</span> <span class="o">+</span> <span class="s1">&#39; detected at channel &#39;</span> <span class="o">+</span> <span class="nx">channel</span> <span class="o">+</span> <span class="s1">&#39; index &#39;</span> <span class="o">+</span>
                  <span class="nx">index</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BadValueDetector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">channel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span> <span class="o">==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">||</span>
                <span class="nx">value</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span>
                <span class="nb">isNaN</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">||</span>
                <span class="nx">value</span> <span class="o">==</span> <span class="kc">Infinity</span> <span class="o">||</span>
                <span class="nx">value</span> <span class="o">==</span> <span class="o">-</span><span class="kc">Infinity</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BadValueDetector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Bad Value Detector&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>TriggerControl</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/TriggerControl.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Simple trigger which allows you to set a single sample to be 1 at the start
of a processing block</p>

<p><strong>Outputs</strong></p>

<ul>
<li>Triggers</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>trigger Set to 1 to fire a trigger.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [trigger=0] The initial trigger state.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">TriggerControl</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">trigger</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">trigger</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">TriggerControl</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">TriggerControl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">triggerParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">trigger</span> <span class="o">=</span> <span class="nx">triggerParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">trigger</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">channel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="nx">triggerParameter</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
            <span class="nx">trigger</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">channel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">TriggerControl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Trigger Control&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
    </body>
</html>
